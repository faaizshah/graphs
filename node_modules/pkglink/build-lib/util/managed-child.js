"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = runAsChild;

var _ramda = _interopRequireDefault(require("ramda"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function runAsChild(INTERRUPT_TYPE) {
  var onInterrupt = function onInterrupt(fn) {
    // set the onInterrupt fn to call
    var interruptOnce = _ramda["default"].once(fn);

    process.once('SIGINT', interruptOnce).once('SIGTERM', interruptOnce).on('message', function (msg) {
      if (msg && msg.type === INTERRUPT_TYPE) {
        interruptOnce();
      }
    });
  };

  var shutdown = _ramda["default"].once(function () {
    process.disconnect();
  });

  return {
    onInterrupt: onInterrupt,
    shutdown: shutdown
  };
}