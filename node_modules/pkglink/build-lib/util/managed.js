"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _managedChild = _interopRequireDefault(require("./managed-child"));

var _managedMaster = _interopRequireDefault(require("./managed-master"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var INTERRUPT_TYPE = 'INTERRUPT_SHUTDOWN';
/*
  Handles setting up signals and if we are running
  a child process then it hooks signals up so we can
  do a graceful shutdown on Control-c including from
  Windows.
 */

var launchWorkerMain = function launchWorkerMain() {}; // defined later


function launchWorker(script, opts) {
  return launchWorkerMain(script, opts);
}

if (process.disconnect) {
  // running as a child
  var childMethods = (0, _managedChild["default"])(INTERRUPT_TYPE);
  launchWorker.onInterrupt = childMethods.onInterrupt;
  launchWorker.shutdown = childMethods.shutdown;
} else {
  // otherwise running as master
  var masterMethods = (0, _managedMaster["default"])(INTERRUPT_TYPE);
  launchWorkerMain = masterMethods.launchChildWorker;
  launchWorker.onInterrupt = masterMethods.onInterrupt;
  launchWorker.shutdown = masterMethods.shutdown;
}

var _default = launchWorker;
exports["default"] = _default;